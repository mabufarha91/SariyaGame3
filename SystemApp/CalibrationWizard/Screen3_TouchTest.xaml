<Window x:Class="KinectCalibrationWPF.CalibrationWizard.Screen3_TouchTest"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Calibration Wizard - Screen 3: Touch Detection Test" Height="800" Width="1200"
        WindowStartupLocation="CenterScreen" ResizeMode="CanResize">
	<Window.Resources>
		<Style x:Key="WizardButtonStyle" TargetType="Button">
			<Setter Property="Padding" Value="15,8"/>
			<Setter Property="FontSize" Value="14"/>
			<Setter Property="FontWeight" Value="Bold"/>
			<Setter Property="Foreground" Value="White"/>
			<Setter Property="Background" Value="#2196F3"/>
			<Setter Property="BorderThickness" Value="0"/>
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="Button">
						<Border Background="{TemplateBinding Background}" CornerRadius="4">
							<ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
						</Border>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
		</Style>
	</Window.Resources>
	
	<Grid>
		<Grid.RowDefinitions>
			<RowDefinition Height="Auto"/>
			<RowDefinition Height="*"/>
			<RowDefinition Height="Auto"/>
		</Grid.RowDefinitions>
		
		<!-- Header -->
		<Border Grid.Row="0" Background="#1976D2" Padding="20">
			<StackPanel>
				<TextBlock Text="Calibration Wizard - Screen 3" FontSize="24" FontWeight="Bold" Foreground="White" HorizontalAlignment="Center"/>
				<TextBlock Text="Test the touch detection. A red square will appear on detected objects. Adjust sensitivity as needed." FontSize="14" Foreground="White" HorizontalAlignment="Center" Margin="0,5,0,0"/>
			</StackPanel>
		</Border>
		
		<!-- Main Content -->
		<Grid Grid.Row="1">
			<Grid.ColumnDefinitions>
				<ColumnDefinition Width="2*"/>
				<ColumnDefinition Width="*"/>
			</Grid.ColumnDefinitions>
			
			<!-- Depth View -->
			<Border Grid.Column="0" Background="White" CornerRadius="8" Margin="0,0,10,0">
				<Grid>
					<Grid.RowDefinitions>
						<RowDefinition Height="*"/>
						<RowDefinition Height="Auto"/>
					</Grid.RowDefinitions>
					<Border Grid.Row="0" Background="#000" Margin="10">
						<Viewbox x:Name="DepthViewContainer" Stretch="Uniform" HorizontalAlignment="Center" VerticalAlignment="Center">
							<Grid>
								<Grid.RenderTransform>
									<TransformGroup x:Name="DepthViewTransformGroup">
										<ScaleTransform x:Name="DepthScaleTransform"/>
										<ScaleTransform x:Name="DepthFlipTransform" ScaleY="-1"/>
										<TranslateTransform x:Name="DepthTranslateTransform"/>
									</TransformGroup>
								</Grid.RenderTransform>
								<Image x:Name="DepthImage" Stretch="Fill"/>
								<Canvas x:Name="OverlayCanvas" Background="Transparent"/>
							</Grid>
						</Viewbox>
					</Border>
					<Border Grid.Row="1" Background="#F0F0F0" Padding="10">
						<TextBlock x:Name="StatusText" Text="Ready" HorizontalAlignment="Center" FontSize="12"/>
					</Border>
				</Grid>
			</Border>
			
			<!-- Simple Controls -->
			<Border Grid.Column="1" Background="White" CornerRadius="8" Margin="10,0,0,0">
				<ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
					<StackPanel Margin="20">
					
					<!-- SIMPLE TOUCH DETECTION -->
					<GroupBox Header="ðŸŽ¯ Touch Detection" Margin="0,0,0,20">
						<StackPanel Margin="10">
							<TextBlock Text="Sensitivity" FontWeight="Bold" Margin="0,0,0,5"/>
							<Slider x:Name="PlaneThresholdSlider" Width="200" ValueChanged="PlaneThresholdSlider_ValueChanged"/>
							<TextBlock x:Name="ThresholdValueText" Text="0.010 m" HorizontalAlignment="Center" FontSize="14" FontWeight="Bold" Foreground="#2196F3" Margin="0,5,0,15"/>
							
							<Button x:Name="ShowTouchDetectionButton" Content="ðŸ‘ï¸ SHOW TOUCH DETECTION" Style="{StaticResource WizardButtonStyle}" Margin="0,5,0,0" Background="#FF5722" Click="ShowTouchDetectionButton_Click"/>
							<Button x:Name="CaptureBackgroundButton" Content="ðŸ“¸ CAPTURE BACKGROUND" Style="{StaticResource WizardButtonStyle}" Margin="0,5,0,0" Background="#4CAF50" Click="CaptureBackgroundButton_Click"/>
						</StackPanel>
					</GroupBox>
					
					<!-- STATUS -->
					<GroupBox Header="ðŸ“Š Status" Margin="0,0,0,20">
						<StackPanel Margin="10">
							<TextBlock x:Name="DetectionStatusText" Text="No touches detected" FontSize="14" Margin="0,0,0,5" FontWeight="Bold"/>
							<TextBlock x:Name="TouchCountText" Text="Active touches: 0" FontSize="12" Margin="0,0,0,5"/>
							<TextBlock x:Name="DepthInfoText" Text="Depth: --" FontSize="12"/>
						</StackPanel>
					</GroupBox>
					
					<!-- MAIN ACTIONS -->
					<Button x:Name="ResetViewButton" Content="ðŸ”„ RESET VIEW" Style="{StaticResource WizardButtonStyle}" Margin="0,10,0,0" Background="#607D8B" Click="ResetViewButton_Click"/>
					
					<!-- ADVANCED (HIDDEN BY DEFAULT) -->
					<Expander Header="âš™ï¸ Advanced Settings" Margin="0,20,0,20" IsExpanded="False">
						<StackPanel>
							<GroupBox Header="Camera View" Margin="0,0,0,15">
								<StackPanel Margin="10">
									<TextBlock Text="Zoom" FontWeight="Bold" Margin="0,0,0,5"/>
									<Slider x:Name="DepthCameraZoomSlider" Width="200" ValueChanged="DepthCameraZoomSlider_ValueChanged"/>
									<TextBlock x:Name="DepthCameraZoomValueText" Text="1.0x" HorizontalAlignment="Center" FontSize="12" Margin="0,5,0,10"/>
									<CheckBox x:Name="FlipDepthVerticallyCheckBox" IsChecked="True" Content="Flip depth vertically" Checked="FlipDepthVerticallyCheckBox_Changed" Unchecked="FlipDepthVerticallyCheckBox_Changed"/>
								</StackPanel>
							</GroupBox>
							
							<GroupBox Header="Touch Settings" Margin="0,0,0,15">
								<StackPanel Margin="10">
									<TextBlock Text="Min Touch Size" FontWeight="Bold" Margin="0,0,0,5"/>
									<Slider x:Name="MinBlobAreaSlider" Width="200" ValueChanged="MinBlobAreaSlider_ValueChanged"/>
									<TextBlock x:Name="MinBlobAreaValueText" Text="50 pts" HorizontalAlignment="Center" FontSize="12" Margin="0,5,0,10"/>
									
									<TextBlock Text="Touch Area X Offset" FontWeight="Bold" Margin="0,10,0,5"/>
									<Slider x:Name="TouchAreaXOffsetSlider" Width="200" ValueChanged="TouchAreaXOffsetSlider_ValueChanged"/>
									<TextBlock x:Name="TouchAreaXOffsetValueText" Text="0 px" HorizontalAlignment="Center" FontSize="12" Margin="0,5,0,10"/>
									
									<TextBlock Text="Touch Area Y Offset" FontWeight="Bold" Margin="0,0,0,5"/>
									<Slider x:Name="TouchAreaYOffsetSlider" Width="200" ValueChanged="TouchAreaYOffsetSlider_ValueChanged"/>
									<TextBlock x:Name="TouchAreaYOffsetValueText" Text="0 px" HorizontalAlignment="Center" FontSize="12" Margin="0,5,0,10"/>
								</StackPanel>
							</GroupBox>
							
							<Button x:Name="DiagnosticButton" Content="ðŸ“Š Generate Diagnostics" Style="{StaticResource WizardButtonStyle}" Margin="0,0,0,10" Background="#FF9800" Click="DiagnosticButton_Click"/>
							<Button x:Name="VerifyCalibrationButton" Content="ðŸ” Verify Calibration" Style="{StaticResource WizardButtonStyle}" Margin="0,0,0,0" Background="#9C27B0" Click="VerifyCalibrationButton_Click"/>
						</StackPanel>
					</Expander>
					
					<!-- FINAL ACTIONS -->
					<Button x:Name="FinishButton" Content="ðŸ’¾ Save &amp; Exit" Style="{StaticResource WizardButtonStyle}" Margin="0,10,0,0" Click="FinishButton_Click"/>
					<Button x:Name="CancelButton" Content="âŒ Cancel" Style="{StaticResource WizardButtonStyle}" Margin="0,10,0,0" Background="#F44336" Click="CancelButton_Click"/>
					</StackPanel>
				</ScrollViewer>
			</Border>
		</Grid>
		<Border Grid.Row="2" Background="#424242" Padding="10">
			<TextBlock Text="Screen 3 of 3: Touch Detection Test" Foreground="White" HorizontalAlignment="Center" FontSize="12"/>
		</Border>
	</Grid>
</Window>