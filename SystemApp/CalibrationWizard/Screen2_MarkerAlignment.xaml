<Window x:Class="KinectCalibrationWPF.CalibrationWizard.Screen2_MarkerAlignment"
         xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
         xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
         Title="Calibration Wizard - Screen 2: Sensor Alignment" Height="700" Width="1000" WindowStartupLocation="CenterScreen" Background="#F5F5F5">
	<Grid>
		<Grid.RowDefinitions>
			<RowDefinition Height="Auto"/>
			<RowDefinition Height="*"/>
			<RowDefinition Height="Auto"/>
		</Grid.RowDefinitions>
		<Border Grid.Row="0" Background="#2196F3" Padding="20">
			<StackPanel>
				<TextBlock Text="Calibration Wizard - Screen 2" FontSize="24" FontWeight="Bold" Foreground="White" HorizontalAlignment="Center"/>
				<TextBlock Text="Place physical markers in view. Adjust settings if needed, then click 'Find Markers'." FontSize="14" Foreground="#E3F2FD" HorizontalAlignment="Center" Margin="0,5,0,0"/>
			</StackPanel>
		</Border>
		<Grid Grid.Row="1" Margin="20">
			<Grid.ColumnDefinitions>
				<ColumnDefinition Width="1*"/>
				<ColumnDefinition Width="2*"/>
			</Grid.ColumnDefinitions>
			<Border Grid.Column="0" Background="White" CornerRadius="8" Margin="0,0,10,0">
				<Grid>
					<Grid.RowDefinitions>
						<RowDefinition Height="*"/>
						<RowDefinition Height="Auto"/>
						<RowDefinition Height="Auto"/>
					</Grid.RowDefinitions>
					<Border Grid.Row="0" Background="#2C2C2C" Margin="10">
						<Grid>
							<Grid.RowDefinitions>
								<RowDefinition Height="*"/>
								<RowDefinition Height="Auto"/>
							</Grid.RowDefinitions>
							<Grid Grid.Row="0">
								<Image x:Name="CameraFeed" Stretch="Uniform"/>
								<Canvas x:Name="MarkersOverlay" Background="Transparent" ClipToBounds="True"/>
							</Grid>
						</Grid>
					</Border>
					<Border Grid.Row="1" Background="#F0F0F0" Padding="10">
						<TextBlock x:Name="CameraStatusText" Text="Camera: Initializing..." HorizontalAlignment="Center" FontSize="12"/>
					</Border>
				</Grid>
			</Border>
			<Border Grid.Column="1" Background="White" CornerRadius="8" Margin="10,0,0,0">
				<Grid Margin="20">
					<Grid.RowDefinitions>
						<RowDefinition Height="Auto"/>
						<RowDefinition Height="*"/>
						<RowDefinition Height="Auto"/>
						<RowDefinition Height="Auto"/>
					</Grid.RowDefinitions>
					<TextBlock Grid.Row="0" Text="Controls" FontSize="16" FontWeight="Bold" Foreground="#424242"/>
					<!-- Hide/Show Camera button moved to bottom action bar -->
					<Grid Grid.Row="1">
						<Grid.ColumnDefinitions>
							<ColumnDefinition Width="*"/>
							<ColumnDefinition Width="2*"/>
						</Grid.ColumnDefinitions>
						<GroupBox Grid.Column="0" Header="Detection Settings" Margin="0,0,5,0">
							<StackPanel Margin="10">
								<TextBlock Text="QR Size"/>
								<Slider x:Name="QrSizeSlider" Minimum="0.5" Maximum="3.0" Value="1.0" Margin="0,4,0,0" ValueChanged="QrSizeSlider_ValueChanged"/>
								<StackPanel Orientation="Horizontal" Margin="0,10,0,0">
									<Button x:Name="FindMarkersButton" Content="Find Markers" Style="{StaticResource WizardButtonStyle}" Click="FindMarkersButton_Click"/>
								</StackPanel>
								<StackPanel Orientation="Horizontal" Margin="0,5,0,0">
									<Button x:Name="TestMarker0Button" Content="ðŸ” Test Marker ID 0 Only" Background="#FF9800" Foreground="White" FontSize="14" Padding="20,10" Margin="5" BorderThickness="0" Click="TestMarker0Button_Click"/>
								</StackPanel>
								<CheckBox x:Name="EnableVerboseLogging" Content="Save detection diagnostics (recommended)" IsChecked="True" Margin="0,8,0,0"/>
								<TextBlock x:Name="StatusText" Text="Status: Not Calibrated" Margin="0,10,0,0" Foreground="#B71C1C"/>
							</StackPanel>
						</GroupBox>
						<GroupBox Grid.Column="1" Header="QR Controllers" Margin="5,0,0,0" MaxHeight="320">
							<UniformGrid Columns="2" Rows="2" Margin="10">
								<Grid>
									<Grid.RowDefinitions>
										<RowDefinition Height="Auto"/>
										<RowDefinition Height="Auto"/>
										<RowDefinition Height="Auto"/>
										<RowDefinition Height="Auto"/>
									</Grid.RowDefinitions>
									<Grid.ColumnDefinitions>
										<ColumnDefinition Width="Auto"/>
										<ColumnDefinition Width="Auto"/>
										<ColumnDefinition Width="Auto"/>
									</Grid.ColumnDefinitions>
									<TextBlock Grid.Row="0" Grid.ColumnSpan="3" Text="QR 1" FontWeight="Bold" HorizontalAlignment="Center"/>
									<RepeatButton Grid.Row="1" Grid.Column="1" Content="â–²" Width="36" Height="28" Delay="200" Interval="50" Click="NudgeM1_Up"/>
									<RepeatButton Grid.Row="2" Grid.Column="0" Content="â—€" Width="36" Height="28" Delay="200" Interval="50" Click="NudgeM1_Left"/>
									<RepeatButton Grid.Row="2" Grid.Column="1" Content="â—" Width="36" Height="28" IsEnabled="False"/>
									<RepeatButton Grid.Row="2" Grid.Column="2" Content="â–¶" Width="36" Height="28" Delay="200" Interval="50" Click="NudgeM1_Right"/>
									<RepeatButton Grid.Row="3" Grid.Column="1" Content="â–¼" Width="36" Height="28" Delay="200" Interval="50" Click="NudgeM1_Down"/>
								</Grid>

								<Grid>
									<Grid.RowDefinitions>
										<RowDefinition Height="Auto"/>
										<RowDefinition Height="Auto"/>
										<RowDefinition Height="Auto"/>
										<RowDefinition Height="Auto"/>
									</Grid.RowDefinitions>
									<Grid.ColumnDefinitions>
										<ColumnDefinition Width="Auto"/>
										<ColumnDefinition Width="Auto"/>
										<ColumnDefinition Width="Auto"/>
									</Grid.ColumnDefinitions>
									<TextBlock Grid.Row="0" Grid.ColumnSpan="3" Text="QR 2" FontWeight="Bold" HorizontalAlignment="Center"/>
									<RepeatButton Grid.Row="1" Grid.Column="1" Content="â–²" Width="36" Height="28" Delay="200" Interval="50" Click="NudgeM2_Up"/>
									<RepeatButton Grid.Row="2" Grid.Column="0" Content="â—€" Width="36" Height="28" Delay="200" Interval="50" Click="NudgeM2_Left"/>
									<RepeatButton Grid.Row="2" Grid.Column="1" Content="â—" Width="36" Height="28" IsEnabled="False"/>
									<RepeatButton Grid.Row="2" Grid.Column="2" Content="â–¶" Width="36" Height="28" Delay="200" Interval="50" Click="NudgeM2_Right"/>
									<RepeatButton Grid.Row="3" Grid.Column="1" Content="â–¼" Width="36" Height="28" Delay="200" Interval="50" Click="NudgeM2_Down"/>
								</Grid>

								<Grid>
									<Grid.RowDefinitions>
										<RowDefinition Height="Auto"/>
										<RowDefinition Height="Auto"/>
										<RowDefinition Height="Auto"/>
										<RowDefinition Height="Auto"/>
									</Grid.RowDefinitions>
									<Grid.ColumnDefinitions>
										<ColumnDefinition Width="Auto"/>
										<ColumnDefinition Width="Auto"/>
										<ColumnDefinition Width="Auto"/>
									</Grid.ColumnDefinitions>
									<TextBlock Grid.Row="0" Grid.ColumnSpan="3" Text="QR 3" FontWeight="Bold" HorizontalAlignment="Center"/>
									<RepeatButton Grid.Row="1" Grid.Column="1" Content="â–²" Width="36" Height="28" Delay="200" Interval="50" Click="NudgeM3_Up"/>
									<RepeatButton Grid.Row="2" Grid.Column="0" Content="â—€" Width="36" Height="28" Delay="200" Interval="50" Click="NudgeM3_Left"/>
									<RepeatButton Grid.Row="2" Grid.Column="1" Content="â—" Width="36" Height="28" IsEnabled="False"/>
									<RepeatButton Grid.Row="2" Grid.Column="2" Content="â–¶" Width="36" Height="28" Delay="200" Interval="50" Click="NudgeM3_Right"/>
									<RepeatButton Grid.Row="3" Grid.Column="1" Content="â–¼" Width="36" Height="28" Delay="200" Interval="50" Click="NudgeM3_Down"/>
								</Grid>

								<Grid>
									<Grid.RowDefinitions>
										<RowDefinition Height="Auto"/>
										<RowDefinition Height="Auto"/>
										<RowDefinition Height="Auto"/>
										<RowDefinition Height="Auto"/>
									</Grid.RowDefinitions>
									<Grid.ColumnDefinitions>
										<ColumnDefinition Width="Auto"/>
										<ColumnDefinition Width="Auto"/>
										<ColumnDefinition Width="Auto"/>
									</Grid.ColumnDefinitions>
									<TextBlock Grid.Row="0" Grid.ColumnSpan="3" Text="QR 4" FontWeight="Bold" HorizontalAlignment="Center"/>
									<RepeatButton Grid.Row="1" Grid.Column="1" Content="â–²" Width="36" Height="28" Delay="200" Interval="50" Click="NudgeM4_Up"/>
									<RepeatButton Grid.Row="2" Grid.Column="0" Content="â—€" Width="36" Height="28" Delay="200" Interval="50" Click="NudgeM4_Left"/>
									<RepeatButton Grid.Row="2" Grid.Column="1" Content="â—" Width="36" Height="28" IsEnabled="False"/>
									<RepeatButton Grid.Row="2" Grid.Column="2" Content="â–¶" Width="36" Height="28" Delay="200" Interval="50" Click="NudgeM4_Right"/>
									<RepeatButton Grid.Row="3" Grid.Column="1" Content="â–¼" Width="36" Height="28" Delay="200" Interval="50" Click="NudgeM4_Down"/>
								</Grid>
						</UniformGrid>
					</GroupBox>
					</Grid>
					<StackPanel Grid.Row="3" Orientation="Horizontal" Margin="0,10,0,0">
						<Button x:Name="CalibrateButton" Content="Calibrate" Width="120" Style="{StaticResource WizardButtonStyle}" IsEnabled="False" Click="CalibrateButton_Click"/>
						<Button x:Name="NextButton" Content="Next" Width="120" Style="{StaticResource WizardButtonStyle}" IsEnabled="False" Click="NextButton_Click"/>
						<Button x:Name="CancelButton" Content="Cancel" Width="120" Margin="10,0,0,0" Style="{StaticResource WizardButtonStyle}" Background="#F44336" Click="CancelButton_Click"/>
						<Button x:Name="HideCameraButton" Content="Hide Camera View" Width="120" Margin="10,0,0,0" Style="{StaticResource WizardButtonStyle}" Click="HideCameraButton_Click"/>
					</StackPanel>
				</Grid>
			</Border>
		</Grid>
		<Border Grid.Row="2" Background="#424242" Padding="10">
			<TextBlock Text="Screen 2 of 3: Sensor Alignment" Foreground="White" HorizontalAlignment="Center" FontSize="12"/>
		</Border>
	</Grid>
</Window>
